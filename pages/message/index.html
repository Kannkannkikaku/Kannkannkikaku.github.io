<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>メッセージ一覧</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="../../images/kann-favicon.png">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <link rel="stylesheet" href="../../css/animation.css">
    <link rel="stylesheet" href="../../css/message.css">
    
    

    <script src="../../js/toggleMenu.js"></script>
    <script src="../../js/animation.js"></script>
    <script src="../../js/imageModal.js"></script>
    <!-- ページフリップのプラグイン -->
    <script type="text/javascript" src="../../js/extras/jquery.min.1.7.js"></script>
    <script type="text/javascript" src="../../js/extras/modernizr.2.5.3.min.js"></script>
    
</head>
<body class="page-sub">
    <button class="menu-btn" onclick="toggleMenu()">
        <img src="../../images/menu.png" alt="メニュー">
    </button>
    <!--headerここから-->
    <header>
        <div class="header">
            <div class="header-title">
                <a href="../../index.html" class="logo">Kannkann企画</a>
                <span class="current-page">＞ メッセージ</span>
            </div>
        </div>
        <nav id="menu" class="side-menu">
            <a href="../message/"><img src="../../images/message.png" alt="メッセージ">メッセージ一覧</a>
            <a href="../illust/"><img src="../../images/illust.png" alt="イラスト">イラスト</a>
            <a href="../information/"><img src="../../images/information.png" alt="インフォ">インフォメーション</a>
            <a href="../../index.html"><img src="../../images/home.png" alt="トップ">トップページ</a>
        </nav>
        <div id="overlay" class="overlay" onclick="closeMenu()"></div>
    </header>
    <!--headerここまで-->
    <div id="page-content">
        <!--mainここから-->
        <main>
            <div class="container">
                <h2>📨 ファンの皆様からのメッセージ</h2>
            </div>
            
            <div class = "letterBook-viewport">
                <div class = "container">
                    <div class ="letterBook">
                        <div class ="hard" style = "background-image: url(../../messages/楽譜表紙.jpg);"></div>
                        <div class ="hard">表紙裏</div>
                        <div style = "background-image: url(../../messages/楽譜ピンク.jpg);"></div>
                        <div style = "background-image: url(../../messages/楽譜黄色.jpg);"></div>
                        <div style = "background-image: url(../../messages/楽譜水色.jpg);"></div>
                        <div style = "background-image: url(../../messages/楽譜緑.jpg);"></div>
                        <div class ="hard">裏表紙裏</div>
                        <div class ="hard" style = "background-image: url(../../messages/楽譜表紙.jpg);"></div>
                    </div>
                </div>
            </div>

            <script type="text/javascript">
                const ASPECT_RATIO = 1.536; // 922 / 600
                
                // 現在のウィンドウ幅に基づいて、本の新しいサイズ（ピクセル値）を計算する関数
                function calculateBookSize() {
                    const viewportWidth = $(window).width();
                    
                    // 768px以下は90%、PCは70%の比率を適用
                    let widthRatio = (viewportWidth <= 768) ? 0.90 : 0.70;
                    
                    // 新しい幅を計算 (ピクセル)
                    const newWidth = Math.round(viewportWidth * widthRatio);
                    
                    // アスペクト比を維持して高さを計算
                    const newHeight = Math.round(newWidth / ASPECT_RATIO);
                    
                    return { width: newWidth, height: newHeight };
                }

                function loadApp() {
                    // 初回ロード時にサイズを計算
                    const initialSize = calculateBookSize();

                    // 1. turn.js の初期化: ピクセル値で初期化
                    $('.letterBook').turn({
                        width: initialSize.width, 
                        height: initialSize.height, 
                        elevation: 20,
                        gradients: true,
                        autoCenter: true
                    });

                    // 2. センタリングの調整とイベントリスナーの設定
                    const $book = $('.letterBook');

                    // ★センタリングとリサイズを実行する共通関数★
                    function applyCenteringAndResize() {
                        const newSize = calculateBookSize();
                        
                        // 1. turn.js のサイズを強制的に変更
                        $book.turn('size', newSize.width, newSize.height);
                        
                        // 2. 水平方向のセンタリングを適用
                        // left: 50% と transform: translate(-50%, 0) で中央寄せ後、
                        // ★ズレを補正するために -1px を追加します。この '1px' を調整してください。★
                        $book.css({
                            'position': 'relative',
                            'left': '50%',
                            'transform': 'translate(-50%, 0)' 
                        });
                    }
                    
                    // 3. イベントハンドラの設定
                    
                    // ページフリップイベント: turn.js の挙動後に位置をリセット
                    $book.bind('turned turning', function() {
                        applyCenteringAndResize();
                    });
                    
                    // ウィンドウサイズ変更イベント: サイズ変更時にリサイズと位置調整
                    $(window).bind('resize', function(){
                        applyCenteringAndResize();
                    }).trigger('resize'); // ページロード時に一度実行
                }

                // Load the HTML4 version if there's not CSS transform

                yepnope({
                    test : Modernizr.csstransforms,
                    yep: ['../../js/lib/turn.js'],
                    nope: ['../../js/lib/turn.html4.min.js'],
                    both: ['../../css/notebook.css'],
                    complete: loadApp
                });
            </script>
        </main>
        <!--mainここまで-->

        <!--footerここから-->
        <footer>
            
            <div class="footer-links">
                <a href="../message/index.html">メッセージ</a>|
                <a href="../illust/index.html">イラスト</a>|
                <a href="../information/index.html">インフォ</a>|
                <a href="../../index.html">TOP</a>
            </div>
            
            <div class="footer-social">
            <a href="https://x.com/kannkikaku?s=21&t=5o0lw-318r4fDGVlBy44OQ" target="_blank" rel="noopener">
                <img src="../../images/X.png" alt="Xアカウント" class="x-icon">
            </a>
            </div>

            <div class="footer-copy">
                © 菅叶和誕生日企画 2025 some rights reserved.
            </div>

        </footer>
        <!--footerここまで-->
    </div>

    <div class="bottom-nav">
        <a href="../message/index.html">
            <img src="../../images/message.png" alt="メッセージ">
            <span>メッセージ</span>
        </a>
        <a href="../illust/index.html">
            <img src="../../images/illust.png" alt="イラスト">
            <span>イラスト</span>
        </a>
        <a href="../information/index.html">
            <img src="../../images/information.png" alt="インフォ">
            <span>インフォ</span>
        </a>
        <a href="../../index.html">
            <img src="../../images/home.png" alt="TOPに戻る">
            <span>TOP</span>
        </a>
    </div>

    <script src="../../js/transition.js"></script>
</body>
</html>